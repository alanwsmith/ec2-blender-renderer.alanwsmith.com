<!DOCTYPE html>
<html>
  <head>
    <script src="/assets/chartjs/chart-3-9-1.min.js"></script>
    <script src="/assets/chartjs/chartjs-plugin-datalabels-2-1-0.min.js"></script>
    <style>
      body {
        background-color: #000;
        color: #270;
      }
    </style>
  </head>
  <body>
    <canvas id="barChartCanvas"></canvas>

    <h3>Notes</h3>
    <ul>
      <li>
        The MBP is my 2021 M1 Max MacBookPro (model 18.4) with 64GB of memory.
      </li>
      <li>
        You have to request quota updates to get access to the 'p' and 'g' type
        instances. As of press time, this is
        <a
          href="https://us-east-1.console.aws.amazon.com/servicequotas/home/services/ec2/quotas"
          >the page to request quota increases</a
        >. Search for 'demand'. Then put in requests for 'Running On-Demand G
        and VT instances' and 'Running On-Demand P instances'. The biggest
        machine 'p' instance is 96 vCPU and the biggest 'g' is 192. They didn't
        give me the 192 max on the 'g' instances the first time I asked.
      </li>

      <li>
        The p4d.24xlarge was not available in `us-east-1a` when i tested. (TODO
        confirm if you did `1b`, `1c`, or `1d` based off the error message
      </li>
    </ul>

    <script>
      Chart.register(ChartDataLabels)
      const barChart = new Chart(document.getElementById('barChartCanvas'), {
        type: 'bar',
        options: {
          layout: {
            padding: {
              top: 50,
            },
          },
          parsing: {
            xAxisKey: 'id',
            yAxisKey: 'seconds',
          },
          plugins: {
            legend: {
              display: false,
            },
          },
          scales: {
            x: {
              ticks: {
                callback: function (value) {
                  const parts = this.getLabelForValue(value).split('~')
                  return [parts[0], parts[1]]
                },
              },
            },
          },
        },
        data: $DATA_OBJECT,
      })

      const sourceColors = barChart.data.datasets[0].backgroundColor
      const colorArray = []
      for (let i = 0; i < barChart.data.datasets[0].data.length; i++) {
        console.log(i)
        colorArray[i] = sourceColors[i % sourceColors.length]
      }
      barChart.data.datasets[0].backgroundColor = colorArray
      barChart.data.datasets[0].backgroundColor[14] = 'blue'
      barChart.update()
    </script>
  </body>
</html>
